CREATE TABLE "OFFENDER_COURSE_ATTENDANCES"
(
    EVENT_ID                      NUMBER(10, 0)                     NOT NULL,
    OFFENDER_BOOK_ID              NUMBER(10, 0)                     NOT NULL,
    EVENT_DATE                    DATE                              NOT NULL,
    START_TIME                    DATE                              NULL,
    END_TIME                      DATE                              NULL,
    EVENT_SUB_TYPE                VARCHAR2(12)                      NOT NULL,
    EVENT_STATUS                  VARCHAR2(12) DEFAULT 'SCH'        NOT NULL,
    COMMENT_TEXT                  VARCHAR2(4000)                    NULL,
    HIDDEN_COMMENT_TEXT           VARCHAR2(240)                     NULL,
    TO_INTERNAL_LOCATION_ID       NUMBER(10, 0)                     NULL,
    CRS_SCH_ID                    NUMBER(10, 0)                     NULL,
    OUTCOME_REASON_CODE           VARCHAR2(12)                      NULL,
    PIECE_WORK                    NUMBER(11, 2)                     NULL,
    ENGAGEMENT_CODE               VARCHAR2(12)                      NULL,
    UNDERSTANDING_CODE            VARCHAR2(12)                      NULL,
    DETAILS                       VARCHAR2(40)                      NULL,
    CREDITED_HOURS                NUMBER(6, 2)                      NULL,
    AGREED_TRAVEL_HOUR            NUMBER(6, 2)                      NULL,
    SUPERVISOR_NAME               VARCHAR2(30)                      NULL,
    BEHAVIOUR_CODE                VARCHAR2(12)                      NULL,
    ACTION_CODE                   VARCHAR2(12)                      NULL,
    SICK_NOTE_RECEIVED_DATE       DATE                              NULL,
    SICK_NOTE_EXPIRY_DATE         DATE                              NULL,
    OFF_PRGREF_ID                 NUMBER(10, 0)                     NULL,
    IN_TIME                       DATE                              NULL,
    OUT_TIME                      DATE                              NULL,
    PERFORMANCE_CODE              VARCHAR2(12)                      NULL,
    REFERENCE_ID                  NUMBER(20, 0)                     NULL,
    TO_ADDRESS_OWNER_CLASS        VARCHAR2(12)                      NULL,
    TO_ADDRESS_ID                 NUMBER(10, 0)                     NULL,
    EVENT_OUTCOME                 VARCHAR2(12)                      NULL,
    OFF_CRS_SCH_REF_ID            NUMBER(20, 0)                     NULL,
    SUPERVISOR_STAFF_ID           NUMBER(10, 0)                     NULL,
    CRS_APPT_ID                   NUMBER(20, 0)                     NULL,
    OFFENDER_COURSE_APPT_RULE_ID  NUMBER(10, 0)                     NULL,
    CRS_ACTY_ID                   NUMBER(10, 0)                     NULL,
    EVENT_TYPE                    VARCHAR2(12)                      NOT NULL,
    CREATE_DATETIME               TIMESTAMP    DEFAULT systimestamp NOT NULL,
    CREATE_USER_ID                VARCHAR2(32) DEFAULT USER         NOT NULL,
    MODIFY_DATETIME               TIMESTAMP                         NULL,
    MODIFY_USER_ID                VARCHAR2(32)                      NULL,
    AGY_LOC_ID                    VARCHAR2(6)                       NULL,
    EVENT_CLASS                   VARCHAR2(12)                      NOT NULL,
    AUDIT_TIMESTAMP               TIMESTAMP                         NULL,
    AUDIT_USER_ID                 VARCHAR2(32)                      NULL,
    AUDIT_MODULE_NAME             VARCHAR2(65)                      NULL,
    AUDIT_CLIENT_USER_ID          VARCHAR2(64)                      NULL,
    AUDIT_CLIENT_IP_ADDRESS       VARCHAR2(39)                      NULL,
    AUDIT_CLIENT_WORKSTATION_NAME VARCHAR2(64)                      NULL,
    AUDIT_ADDITIONAL_INFO         VARCHAR2(256)                     NULL,
    UNEXCUSED_ABSENCE_FLAG        VARCHAR2(1)  DEFAULT 'N'          NULL,
    TO_AGY_LOC_ID                 VARCHAR2(6)                       NULL,
    SESSION_NO                    NUMBER(6, 0)                      NULL,
    OFFENDER_PRG_OBLIGATION_ID    NUMBER(10, 0)                     NULL,
    PROGRAM_ID                    NUMBER(10, 0)                     NULL,
    BONUS_PAY                     NUMBER(11, 3)                     NULL,
    TXN_ID                        NUMBER(10, 0)                     NULL,
    TXN_ENTRY_SEQ                 NUMBER(6, 0)                      NULL,
    PAY_FLAG                      VARCHAR2(1)  DEFAULT 'N'          NULL,
    AUTHORISED_ABSENCE_FLAG       VARCHAR2(1)  DEFAULT 'N'          NULL,
    CONSTRAINT OFFENDER_COURSE_ATTENDANCES_C1 CHECK (EVENT_CLASS IN ('INT_MOV', 'COMM', 'EXT_MOV')),
    CONSTRAINT OFFENDER_COURSE_ATTENDANCES_PK PRIMARY KEY (EVENT_ID),
    CONSTRAINT SYS_C0011265 CHECK ("OFFENDER_BOOK_ID" IS NOT NULL),
    CONSTRAINT SYS_C0011266 CHECK ("EVENT_DATE" IS NOT NULL),
    CONSTRAINT SYS_C0011267 CHECK ("EVENT_SUB_TYPE" IS NOT NULL),
    CONSTRAINT SYS_C0011268 CHECK ("EVENT_STATUS" IS NOT NULL),
    CONSTRAINT SYS_C0011269 CHECK ("EVENT_TYPE" IS NOT NULL),
    CONSTRAINT SYS_C0011270 CHECK ("CREATE_DATETIME" IS NOT NULL),
    CONSTRAINT SYS_C0011271 CHECK ("CREATE_USER_ID" IS NOT NULL),
    CONSTRAINT SYS_C0011272 CHECK ("EVENT_CLASS" IS NOT NULL),
--     CONSTRAINT OFFENDER_COURSE_ATT_FK2 FOREIGN KEY (TXN_ID, TXN_ENTRY_SEQ) REFERENCES OFFENDER_TRANSACTIONS (TXN_ID, TXN_ENTRY_SEQ),
    CONSTRAINT OFF_CRS_ATTD_OFF_BKG_FK FOREIGN KEY (OFFENDER_BOOK_ID) REFERENCES OFFENDER_BOOKINGS (OFFENDER_BOOK_ID),
    CONSTRAINT OFF_CRS_ATTD_OFF_PRG_PROF_FK FOREIGN KEY (OFF_PRGREF_ID) REFERENCES OFFENDER_PROGRAM_PROFILES (OFF_PRGREF_ID),
    CONSTRAINT OFF_CRS_ATT_CRS_ACTY_FK FOREIGN KEY (CRS_ACTY_ID) REFERENCES COURSE_ACTIVITIES (CRS_ACTY_ID),
--     CONSTRAINT OFF_CRS_ATT_OFF_PRG_OB_FK FOREIGN KEY (OFFENDER_PRG_OBLIGATION_ID) REFERENCES OFFENDER_PRG_OBLIGATIONS (OFFENDER_PRG_OBLIGATION_ID),
    CONSTRAINT OFF_CRS_ATT_PRG_SERV_FK FOREIGN KEY (PROGRAM_ID) REFERENCES PROGRAM_SERVICES (PROGRAM_ID)
);
CREATE INDEX OFFENDER_COURSE_ATTENDANCES_N1 ON OFFENDER_COURSE_ATTENDANCES (REFERENCE_ID);
CREATE INDEX OFFENDER_COURSE_ATTENDANCES_N3 ON OFFENDER_COURSE_ATTENDANCES (CRS_ACTY_ID, EVENT_DATE);
CREATE INDEX OFFENDER_COURSE_ATTENDANCES_N4 ON OFFENDER_COURSE_ATTENDANCES (CRS_SCH_ID);
CREATE INDEX OFFENDER_COURSE_ATTENDANCES_N5 ON OFFENDER_COURSE_ATTENDANCES (CRS_APPT_ID);
CREATE INDEX OFFENDER_COURSE_ATTENDANCES_N6 ON OFFENDER_COURSE_ATTENDANCES (EVENT_DATE, PAY_FLAG);
CREATE INDEX OFFENDER_COURSE_ATTENDANCES_N7 ON OFFENDER_COURSE_ATTENDANCES (OFF_PRGREF_ID, EVENT_OUTCOME);
CREATE INDEX OFFENDER_COURSE_ATTENDANCES_N8 ON OFFENDER_COURSE_ATTENDANCES (OFFENDER_PRG_OBLIGATION_ID);
CREATE UNIQUE INDEX OFFENDER_COURSE_ATTENDANCES_PK ON OFFENDER_COURSE_ATTENDANCES (EVENT_ID);
CREATE INDEX OFFENDER_COURSE_ATT_FK2 ON OFFENDER_COURSE_ATTENDANCES (TXN_ID, TXN_ENTRY_SEQ);
CREATE INDEX OFFENDER_COURSE_ATT_NI10 ON OFFENDER_COURSE_ATTENDANCES (AGY_LOC_ID, EVENT_DATE, TO_INTERNAL_LOCATION_ID);
CREATE INDEX OFFENDER_CRS_ATTENDANCES_NI9 ON OFFENDER_COURSE_ATTENDANCES (OFFENDER_BOOK_ID, EVENT_DATE, EVENT_TYPE, CRS_ACTY_ID, PAY_FLAG);
CREATE INDEX OFF_CRS_ATT_PRG_SERV_FK ON OFFENDER_COURSE_ATTENDANCES (PROGRAM_ID);